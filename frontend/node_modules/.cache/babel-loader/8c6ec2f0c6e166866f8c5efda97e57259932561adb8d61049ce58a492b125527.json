{"ast":null,"code":"import{useState,useCallback,useRef,useEffect}from\"react\";export const useHttpClient=()=>{const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState();const activeHttpRequests=useRef([]);const sendRequest=useCallback(async function(url){let method=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"GET\";let body=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;let headers=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};setIsLoading(true);const httpAbortCtrl=new AbortController();activeHttpRequests.current.push(httpAbortCtrl);try{const response=await fetch(url,{method,body,headers,signal:httpAbortCtrl.signal});const responseData=await response.json();activeHttpRequests.current=activeHttpRequests.current.filter(reqCtrl=>reqCtrl!==httpAbortCtrl);if(!response.ok){throw new Error(responseData.message);}setIsLoading(false);return responseData;}catch(err){setError(err.message);setIsLoading(false);throw err;}},[]);const clearError=()=>{setError(null);};useEffect(()=>{return()=>{activeHttpRequests.current.forEach(abortCtrl=>abortCtrl.abort());};},[]);return{isLoading,error,sendRequest,clearError};};","map":{"version":3,"names":["useState","useCallback","useRef","useEffect","useHttpClient","isLoading","setIsLoading","error","setError","activeHttpRequests","sendRequest","url","method","arguments","length","undefined","body","headers","httpAbortCtrl","AbortController","current","push","response","fetch","signal","responseData","json","filter","reqCtrl","ok","Error","message","err","clearError","forEach","abortCtrl","abort"],"sources":["C:/Users/quang/Desktop/Udemy_MERN/frontend/src/shared/hooks/http-hook.js"],"sourcesContent":["import { useState, useCallback, useRef, useEffect } from \"react\";\r\n\r\nexport const useHttpClient = () => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState();\r\n\r\n  const activeHttpRequests = useRef([]);\r\n\r\n  const sendRequest = useCallback(\r\n    async (url, method = \"GET\", body = null, headers = {}) => {\r\n      setIsLoading(true);\r\n      const httpAbortCtrl = new AbortController();\r\n      activeHttpRequests.current.push(httpAbortCtrl);\r\n      try {\r\n        const response = await fetch(url, {\r\n          method,\r\n          body,\r\n          headers,\r\n          signal: httpAbortCtrl.signal,\r\n        });\r\n\r\n        const responseData = await response.json();\r\n\r\n        activeHttpRequests.current = activeHttpRequests.current.filter(reqCtrl => reqCtrl !== httpAbortCtrl)\r\n\r\n        if (!response.ok) {\r\n          throw new Error(responseData.message);\r\n        }\r\n        setIsLoading(false);\r\n        return responseData;\r\n      } catch (err) {\r\n        setError(err.message);\r\n        setIsLoading(false);\r\n        throw err;\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const clearError = () => {\r\n    setError(null);\r\n  };\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      activeHttpRequests.current.forEach((abortCtrl) => abortCtrl.abort());\r\n    };\r\n  }, []);\r\n\r\n  return { isLoading, error, sendRequest, clearError };\r\n};\r\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,WAAW,CAAEC,MAAM,CAAEC,SAAS,KAAQ,OAAO,CAEhE,MAAO,MAAM,CAAAC,aAAa,CAAGA,CAAA,GAAM,CACjC,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGN,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACO,KAAK,CAAEC,QAAQ,CAAC,CAAGR,QAAQ,CAAC,CAAC,CAEpC,KAAM,CAAAS,kBAAkB,CAAGP,MAAM,CAAC,EAAE,CAAC,CAErC,KAAM,CAAAQ,WAAW,CAAGT,WAAW,CAC7B,eAAOU,GAAG,CAAgD,IAA9C,CAAAC,MAAM,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,KAAK,IAAE,CAAAG,IAAI,CAAAH,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,IAAE,CAAAI,OAAO,CAAAJ,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CACnDP,YAAY,CAAC,IAAI,CAAC,CAClB,KAAM,CAAAY,aAAa,CAAG,GAAI,CAAAC,eAAe,CAAC,CAAC,CAC3CV,kBAAkB,CAACW,OAAO,CAACC,IAAI,CAACH,aAAa,CAAC,CAC9C,GAAI,CACF,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACZ,GAAG,CAAE,CAChCC,MAAM,CACNI,IAAI,CACJC,OAAO,CACPO,MAAM,CAAEN,aAAa,CAACM,MACxB,CAAC,CAAC,CAEF,KAAM,CAAAC,YAAY,CAAG,KAAM,CAAAH,QAAQ,CAACI,IAAI,CAAC,CAAC,CAE1CjB,kBAAkB,CAACW,OAAO,CAAGX,kBAAkB,CAACW,OAAO,CAACO,MAAM,CAACC,OAAO,EAAIA,OAAO,GAAKV,aAAa,CAAC,CAEpG,GAAI,CAACI,QAAQ,CAACO,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,CAACL,YAAY,CAACM,OAAO,CAAC,CACvC,CACAzB,YAAY,CAAC,KAAK,CAAC,CACnB,MAAO,CAAAmB,YAAY,CACrB,CAAE,MAAOO,GAAG,CAAE,CACZxB,QAAQ,CAACwB,GAAG,CAACD,OAAO,CAAC,CACrBzB,YAAY,CAAC,KAAK,CAAC,CACnB,KAAM,CAAA0B,GAAG,CACX,CACF,CAAC,CACD,EACF,CAAC,CAED,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvBzB,QAAQ,CAAC,IAAI,CAAC,CAChB,CAAC,CAEDL,SAAS,CAAC,IAAM,CACd,MAAO,IAAM,CACXM,kBAAkB,CAACW,OAAO,CAACc,OAAO,CAAEC,SAAS,EAAKA,SAAS,CAACC,KAAK,CAAC,CAAC,CAAC,CACtE,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,CAAE/B,SAAS,CAAEE,KAAK,CAAEG,WAAW,CAAEuB,UAAW,CAAC,CACtD,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}